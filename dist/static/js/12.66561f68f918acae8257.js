webpackJsonp([12],{S76D:function(t,a){},UKBI:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("Wwjh"),i={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"d-flex flex-row justify-content-between mb-2"},[t._m(0),t._v(" "),e("div",{staticClass:"d-flex flex-row"},[e("div",{staticClass:"py-1 mr-2"},[e("button",{staticClass:"btn btn-success",on:{click:t.newModal}},[e("i",{staticClass:"fas fa-plus"}),t._v("\n              Thêm\n            ")])]),t._v(" "),e("div",[e("form",{staticClass:"input-group",on:{submit:function(a){return a.preventDefault(),t.searchUp()}}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control form-control-sm",attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:t.searchText},on:{input:function(a){a.target.composing||(t.searchText=a.target.value)}}}),t._v(" "),t._m(1)])])])]),t._v(" "),e("table",{staticClass:"table table-hover"},[e("caption",[t._v("\n          List of location\n        ")]),t._v(" "),t._m(2),t._v(" "),e("tbody",[t.isLoading?e("tr",{staticClass:"text-center"},[t._m(3)]):t._l(t.locations.data,function(a,s){return e("tr",{key:s},[e("th",{attrs:{scope:"row"}},[t._v(t._s(++s))]),t._v(" "),e("td",[e("p",{staticClass:"text-truncate",staticStyle:{width:"150px"}},[t._v("\n                "+t._s(a.location_name)+"\n              ")])]),t._v(" "),e("td",[e("p",{staticClass:"text-truncate",staticStyle:{width:"150px"}},[t._v("\n                "+t._s(a.address)+"\n              ")])]),t._v(" "),e("td",[e("p",{staticClass:"text-truncate",staticStyle:{width:"250px"}},[t._v("\n                "+t._s(a.description)+"\n              ")])]),t._v(" "),e("td",{staticClass:"text-center"},[e("a",{staticClass:"mr-2",attrs:{href:"#"},on:{click:function(e){return t.viewAllImage(a)}}},[e("i",{staticClass:"menu-icon icon-images text-dark"})]),t._v(" "),e("a",{staticClass:"mx-2",attrs:{href:"#"},on:{click:function(e){return t.updateModal(a)}}},[e("i",{staticClass:"menu-icon icon-pencil text-info"})]),t._v(" "),e("a",{staticClass:"ml-2",attrs:{href:"#"},on:{click:function(e){return t.deleteModal(a)}}},[e("i",{staticClass:"menu-icon icon-bin2 text-danger"})])])])})],2)]),t._v(" "),e("paginate",{attrs:{"page-count":null==t.locations.last_page?1:t.locations.last_page,"click-handler":t.clickPaginate,"prev-text":"Prev","next-text":"Next","container-class":"pagination justify-content-end","page-class":"page-item","page-link-class":"page-link","prev-class":"page-item","prev-link-class":"page-link","next-class":"page-item","next-link-class":"page-link"}})],1)]),t._v(" "),e("div",{staticClass:"modal fade",attrs:{id:"modalLocation",tabindex:"-1",role:"dialog","aria-labelledby":"modalTitle","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h5",{directives:[{name:"show",rawName:"v-show",value:!t.editMode,expression:"!editMode"}],staticClass:"modal-title",attrs:{id:"modalTitle"}},[t._v("\n            Thêm địa điểm\n          ")]),t._v(" "),e("h5",{directives:[{name:"show",rawName:"v-show",value:t.editMode,expression:"editMode"}],staticClass:"modal-title",attrs:{id:"modalTitle"}},[t._v("\n            Cập nhật địa điểm\n          ")]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:function(a){return t.closeModal()}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),e("form",{on:{submit:function(a){a.preventDefault(),t.editMode?t.updateLocation():t.createLocation()}}},[e("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(a){var s=a.valid;return[e("div",{staticClass:"modal-body"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"locationName"}},[t._v("Tên địa điểm")]),t._v(" "),e("ValidationProvider",{attrs:{name:"location name",rules:"required|max:255"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors;return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.locationName,expression:"locationName"}],staticClass:"form-control",class:{"is-invalid":s[0]},attrs:{type:"text",placeholder:"Tên địa điểm",name:"locationName",id:"locationName"},domProps:{value:t.locationName},on:{input:function(a){a.target.composing||(t.locationName=a.target.value)}}}),t._v(" "),e("div",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"address"}},[t._v("Địa chỉ")]),t._v(" "),e("ValidationProvider",{attrs:{name:"address",rules:"required|max:255"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors;return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.address,expression:"address"}],staticClass:"form-control",class:{"is-invalid":s[0]},attrs:{type:"text",placeholder:"Địa chỉ",name:"address",id:"address"},domProps:{value:t.address},on:{input:function(a){a.target.composing||(t.address=a.target.value)}}}),t._v(" "),e("div",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("Mô tả")]),t._v(" "),e("ValidationProvider",{attrs:{name:"description",rules:"required|min:100"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors;return[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"form-control",class:{"is-invalid":s[0]},attrs:{type:"text",placeholder:"Mô tả"},domProps:{value:t.description},on:{input:function(a){a.target.composing||(t.description=a.target.value)}}}),t._v(" "),e("div",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("Hình\n                  "),e("i",{staticClass:"text-danger"},[t._v("(nên chọn ít nhất 1 hình)")])]),t._v(" "),e("input",{ref:"imageLocations",staticClass:"form-control-file",attrs:{multiple:"",type:"file",accept:"image/*"},on:{change:function(a){return t.handleFileUploads()}}})])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(a){return t.closeModal()}}},[t._v("\n                Huỷ\n              ")]),t._v(" "),e("button",{directives:[{name:"show",rawName:"v-show",value:!t.editMode,expression:"!editMode"}],staticClass:"btn btn-primary",attrs:{type:"submit",disabled:!s}},[t.loadingButton?e("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e(),t._v("\n                Thêm\n              ")]),t._v(" "),e("button",{directives:[{name:"show",rawName:"v-show",value:t.editMode,expression:"editMode"}],staticClass:"btn btn-primary",attrs:{type:"submit",disabled:!s}},[t.loadingButton?e("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e(),t._v("\n                Cập nhật\n              ")])])]}}])})],1)])])]),t._v(" "),e("submit-delete-modal",[e("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("\n        Huỷ\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.submitDelete}},[t.loadingButton?e("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e(),t._v("\n        Có\n      ")])])]),t._v(" "),e("details-modal",[e("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"modalTitle"}},[t._v("Hình ảnh")]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:function(a){return t.closeViewImage()}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),e("div",{staticClass:"modal-body p-3",attrs:{slot:"modal-body"},slot:"modal-body"},[0!==t.data.length?e("carousel",{attrs:{data:t.data,"indicator-type":"disc",autoplay:!1}}):e("p",{staticClass:"text-center lead"},[t._v("Không có hình ảnh nào")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",[a("h5",{staticClass:"card-title"},[this._v("Danh sách địa điểm")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-light",attrs:{type:"submit"}},[a("i",{staticClass:"fas fa-search"})])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("STT")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Tên địa điểm")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Địa chỉ")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Mô tả")]),t._v(" "),e("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Tuỳ chọn")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("td",{attrs:{colspan:"8"}},[a("div",{staticClass:"spinner-border",attrs:{role:"status"}},[a("span",{staticClass:"sr-only"},[this._v("Loading...")])])])}]};var o=function(t){e("S76D")},n=e("VU/8")(s.a,i,!1,o,null,null);a.default=n.exports},Wwjh:function(t,a,e){"use strict";(function(t){var s=e("Xxa5"),i=e.n(s),o=e("exGp"),n=e.n(o),r=e("Dd8w"),l=e.n(r),c=e("NYxO"),d=e("IcnI");a.a={data:function(){return{editMode:!1,loadingButton:!1,id:"",locationName:"",address:"",description:"",files:[],data:[],searchText:""}},created:function(){d.a.dispatch("location/LOCATIONS_FETCH"),d.a.dispatch("imagelocation/IMAGES_FETCH")},computed:l()({},Object(c.c)("location",["locations","isLoading"]),Object(c.c)("imagelocation",["images","isLoadingImage"])),methods:l()({},Object(c.b)("location",["LOCATION_CREATE","LOCATION_UPDATE","LOCATION_DELETE","LOCATIONS_PAGINATE","LOCATIONS_SEARCH"]),Object(c.b)("imagelocation",["IMAGES_CREATE","IMAGES_DELETE"]),{handleFileUploads:function(){this.files=this.$refs.imageLocations.files},clickPaginate:function(t){this.LOCATIONS_PAGINATE(t)},searchUp:function(){this.LOCATIONS_SEARCH(this.searchText)},newModal:function(){this.editMode=!1,this.id="",this.locationName="",this.address="",this.description="",this.files=[],t("#modalLocation").modal("show")},closeModal:function(){this.editMode=!1,this.id="",this.locationName="",this.address="",this.description="",this.files=[],t("#modalLocation").modal("hide")},viewAllImage:function(a){var e=this;return n()(i.a.mark(function s(){var o,n,r,l,c;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:for(n=(o=e).images.length,r=[],l=0;l<n;l++)c="https://storage.googleapis.com/cdio-cots.appspot.com/uploads/locations/",o.images[l].location.id===a.id&&(c+=o.images[l].image_name,r.push('<img class="post-image w-100" src="'+c+'" />'));return s.next=6,r;case 6:e.data=s.sent,t(".details__modal").modal("show");case 8:case"end":return s.stop()}},s,e)}))()},closeViewImage:function(){this.data=[],t(".details__modal").modal("hide")},updateModal:function(a){this.editMode=!0,this.id=a.id,this.locationName=a.location_name,this.address=a.address,this.description=a.description,t("#modalLocation").modal("show")},deleteModal:function(a){this.id=a.id,t(".submit__delete__modal").modal("show")},createLocation:function(){var a=this;return n()(i.a.mark(function e(){var s,o,n,r,l,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=a.files,o=s.length,a.loadingButton=!0,n={location_name:a.locationName,address:a.address,description:a.description},e.prev=4,e.next=7,a.LOCATION_CREATE(n);case 7:if(r=e.sent,!(o<=0)){e.next=13;break}return t("#modalLocation").modal("hide"),a.loadingButton=!1,a.$toast.success({color:"#51A351",title:"Success!",message:"Thêm địa điểm thành công"}),e.abrupt("return");case 13:for(l=0;l<o;l++)(c=new FormData).append("image_name",s[l]),c.append("location_id",r.id),a.IMAGES_CREATE(c);t("#modalLocation").modal("hide"),a.loadingButton=!1,a.$toast.success({color:"#51A351",title:"Success!",message:"Thêm địa điểm thành công"}),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(4),t("#modalLocation").modal("hide"),a.loadingButton=!1,a.$toast.error({color:"#BD362F",title:"Error!",message:"Thêm địa điểm thất bại"});case 24:case"end":return e.stop()}},e,a,[[4,19]])}))()},updateLocation:function(){var a=this;return n()(i.a.mark(function e(){var s,o,n,r,l;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.loadingButton=!0,s=a.files,o=s.length,n={id:a.id,updatedFields:{location_name:a.locationName,address:a.address,description:a.description}},e.prev=4,e.next=7,a.LOCATION_UPDATE(n);case 7:if(e.sent,!(o<=0)){e.next=13;break}return t("#modalLocation").modal("hide"),a.loadingButton=!1,a.$toast.success({color:"#51A351",title:"Success!",message:"Cập nhật địa điểm thành công"}),e.abrupt("return");case 13:for(a.IMAGES_DELETE(a.id),r=0;r<o;r++)(l=new FormData).append("image_name",s[r]),l.append("location_id",a.id),a.IMAGES_CREATE(l);t("#modalLocation").modal("hide"),a.loadingButton=!1,a.$toast.success({color:"#51A351",title:"Success!",message:"Cập nhật địa điểm thành công"}),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(4),t("#modalLocation").modal("hide"),a.loadingButton=!1,a.$toast.error({color:"#BD362F",title:"Error!",message:"Cập nhật địa điểm thất bại"});case 25:case"end":return e.stop()}},e,a,[[4,20]])}))()},submitDelete:function(){var a=this;return n()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.loadingButton=!0,e.prev=1,e.next=4,a.LOCATION_DELETE(a.id);case 4:a.IMAGES_DELETE(a.id),t(".submit__delete__modal").modal("hide"),a.loadingButton=!1,a.$toast.success({color:"#51A351",title:"Success!",message:"Xoá địa điểm thành công"}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),t(".submit__delete__modal").modal("hide"),a.loadingButton=!1,a.$toast.error({color:"#BD362F",title:"Error!",message:"Xoá địa điểm thất bại"});case 15:case"end":return e.stop()}},e,a,[[1,10]])}))()}})}}).call(a,e("7t+N"))}});
//# sourceMappingURL=12.66561f68f918acae8257.js.map