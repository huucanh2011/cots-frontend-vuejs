webpackJsonp([4],{"I+ZL":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("VDu0"),n={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-3 pr-2"},[e("div",{staticClass:"card shadow rounded-lg border-0 sticky-top"},[e("div",{staticClass:"card-body"},[e("h4",{staticClass:"card-title text-center text-uppercase"},[t._v("\n          Địa điểm nổi bật\n        ")]),t._v(" "),t.isLoading?e("div",{staticClass:"text-center py-5"},[t._m(0)]):t._l(t.topLocations,function(s){return e("router-link",{key:s.id,staticClass:"card-link text-dark",attrs:{to:{name:"Location Detail",params:{locationId:s.id}},title:s.location_name}},[e("div",{staticClass:"d-flex flex-row justify-content-between"},[e("p",{staticClass:"text-truncate my-1 mr-3"},[t._v("\n              "+t._s(s.location_name)+"\n            ")]),t._v(" "),e("span",{staticClass:"font-weight-bold text-warning my-1"},[t._v("\n              "+t._s(t._f("myRating")(s.avg_location_scores))+"\n              ")])])])})],2)])]),t._v(" "),e("div",{staticClass:"col-md-6 px-2"},[null!=t.currentUser?e("div",{staticClass:"row mb-3"},[e("div",{staticClass:"col-6 pr-2"},[e("button",{staticClass:"btn btn-secondary btn-lg btn-block",attrs:{type:"button"},on:{click:function(s){return t.onClickBookTour()}}},[e("i",{staticClass:"fas fa-route mr-3"}),t._v("ĐẶT TOUR\n        ")])]),t._v(" "),e("div",{staticClass:"col-6 pl-2"},[e("button",{staticClass:"btn btn-info btn-lg btn-block",attrs:{type:"button",disabled:t.isCardShow},on:{click:function(s){return t.onClickPost()}}},[e("i",{staticClass:"far fa-newspaper mr-3"}),t._v("ĐĂNG BÀI\n        ")])])]):t._e(),t._v(" "),t.showCardPost?e("div",{staticClass:"card shadow rounded-lg border-0"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"d-flex"},[t._m(1),t._v(" "),e("div",{staticClass:"ml-auto"},[e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(s){return t.onCloseCardPost()}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])]),t._v(" "),e("form",{on:{submit:function(s){return s.preventDefault(),t.createPost()}}},[e("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(s){var a=s.valid;return[e("div",{staticClass:"form-group"},[e("vue-bootstrap-typeahead",{attrs:{data:t.locations,serializer:function(t){return t.location_name},placeholder:"Tìm địa điểm..."},on:{hit:function(s){t.selectedLocation=s}},model:{value:t.searchLocationText,callback:function(s){t.searchLocationText=s},expression:"searchLocationText"}})],1),t._v(" "),e("div",{staticClass:"form-gourp my-3"},[e("ValidationProvider",{attrs:{name:"content",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){var a=s.errors;return[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.postContent,expression:"postContent"}],staticClass:"form-control",class:{"is-invalid":a[0]},attrs:{placeholder:"Bạn suy nghĩ gì...",rows:"2"},domProps:{value:t.postContent},on:{input:function(s){s.target.composing||(t.postContent=s.target.value)}}}),t._v(" "),e("div",{staticClass:"invalid-feedback"},[t._v(t._s(a[0]))])]}}],null,!0)})],1),t._v(" "),e("div",{staticClass:"form-group d-flex flex-row"},[e("div",{staticClass:"ml-0"},[e("label",[t._v("Chọn hình")]),t._v(" "),e("input",{ref:"imageUploads",staticClass:"form-control-file",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:function(s){return t.handleFileUploads()}}})]),t._v(" "),e("div",{staticClass:"ml-auto"},[e("label",[t._v("Điểm")]),t._v(" "),e("ValidationProvider",{attrs:{name:"content",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){return s.errors,[e("star-rating",{attrs:{"star-size":20,"show-rating":!1},model:{value:t.rating,callback:function(s){t.rating=s},expression:"rating"}})]}}],null,!0)})],1)]),t._v(" "),e("button",{staticClass:"btn btn-dark btn-block",attrs:{type:"submit",disabled:!a}},[t.loadingButton?e("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e(),t._v("\n              Đăng\n            ")])]}}],null,!1,1811918810)})],1)])]):t._e(),t._v(" "),t.isLoading?e("div",{staticClass:"text-center py-5"},[t._m(2)]):t._l(t.posts.data,function(s,a){return e("div",{key:a,staticClass:"card shadow rounded-lg border-0"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"post"},[e("div",{staticClass:"post-header"},[e("img",{staticClass:"border",attrs:{src:t.getUrlImage(s.user.avatar)}}),t._v(" "),e("div",{staticClass:"d-flex flex-row"},[e("div",{staticClass:"d-flex flex-column post-info"},[e("div",{staticClass:"d-flex flex-row"},[e("router-link",{staticClass:"text-center text-info mr-4",attrs:{to:{name:"Location Detail",params:{locationId:s.location.id}}}},[e("i",{staticClass:"fas fa-map-marker-alt"}),t._v("\n                    "+t._s(s.location.location_name)+"\n                  ")]),t._v(" "),e("span",{staticClass:"text-warning mr-auto"},[t._v(t._s(s.post_scores)),e("i",{staticClass:"fas fa-star mx-1"})])],1),t._v(" "),e("div",{staticClass:"d-flex flex-row"},[e("span",{staticClass:"post-author mr-4"},[t._v(t._s(s.user.name))]),t._v(" "),e("span",{staticClass:"post-date"},[t._v(t._s(t._f("myDate2")(s.created_at)))])])]),t._v(" "),e("div",{staticClass:"ml-auto"},[!0===t.isAuthenticated&&t.currentUser.id===s.user_id?e("div",{staticClass:"d-flex flex-row"},[e("a",{staticClass:"text-danger mx-3",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.onClickDeletePost(s.id)}}},[e("i",{staticClass:"fas fa-trash"})])]):t._e()])])]),t._v(" "),e("div",{staticClass:"post-body"},[e("p",[t._v(t._s(s.post_content))]),t._v(" "),e("carousel",{attrs:{data:t.getImageData(s.image_posts),"indicator-type":"disc"}})],1),t._v(" "),e("div",{staticClass:"post-actions"},[e("ul",{staticClass:"list-unstyled"},[e("li",[e("a",{staticClass:"like-btn",attrs:{href:"#"}},[e("i",{staticClass:"far fa-heart"}),t._v(" "+t._s(s.likes.length)+" Like\n                ")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#"},on:{click:function(e){return t.onClickCommentPost(s.id)}}},[e("i",{staticClass:"far fa-comment"}),t._v(" 0 Comment")])])])]),t._v(" "),e("div",{staticClass:"post-comments"},[t._l(t.comments,function(a,n){return e("div",{key:n,staticClass:"my-2"},[a.post_id===s.id?e("div",{staticClass:"post-comm"},[e("img",{staticClass:"comment-img border",attrs:{src:t.getUrlImage(a.user.avatar)}}),t._v(" "),e("div",{staticClass:"comment-container"},[e("span",{staticClass:"comment-author"},[t._v("\n                    "+t._s(a.user.name)+"\n                    "),e("i",{staticClass:"font-weight-normal text-muted"},[t._v("- "+t._s(t._f("myDate2")(a.created_at))+" -")]),t._v(" "),null!=t.currentUser&&a.user.id===t.currentUser.id?e("small",{staticClass:"comment-date"},[t.optionComment&&t.onListenerClickEditComment(a.id)?e("a",{staticClass:"text-info",attrs:{href:"#"},on:{click:function(s){return t.openEditComment(a)}}},[e("i",{staticClass:"fas fa-pen"})]):t._e(),t._v(" "),t.optionComment&&t.onListenerClickEditComment(a.id)?e("a",{staticClass:"text-danger mx-3",attrs:{href:"#"},on:{click:function(s){return t.deleteComment(a.id)}}},[e("i",{staticClass:"fas fa-trash"})]):t._e(),t._v(" "),e("a",{staticClass:"text-dark",attrs:{href:"#"},on:{click:function(s){return t.toggleMenuComment(a.id)}}},[e("i",{staticClass:"fas fa-ellipsis-v"})])]):t._e()])]),t._v(" "),e("span",{staticClass:"comment-text"},[t._v("\n                  "+t._s(a.comment_content)+"\n                ")])]):t._e()])}),t._v(" "),t.isAuthenticated?e("div",{staticClass:"new-comment mt-2"},[t.commentMode&&t.onListenerClick(s.id)?e("div",[e("form",{on:{submit:function(e){return e.preventDefault(),t.sendComment(s.id)}}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.commentContent,expression:"commentContent"}],staticClass:"form-control search-input rounded-pill",attrs:{type:"text",placeholder:"Nhập bình luận..."},domProps:{value:t.commentContent},on:{input:function(s){s.target.composing||(t.commentContent=s.target.value)}}})])]):t._e()]):t._e()],2)])])])}),t._v(" "),t.isLoading?t._e():e("div",{staticClass:"text-center mb-4"},[t.loadingLoadMore?e("div",{staticClass:"text-center mb-4"},[t._m(3)]):e("div",[e("button",{staticClass:"btn btn-sm btn-secondary rounded-pill",attrs:{type:"button"},on:{click:function(s){return t.paginatePost()}}},[t._v("\n          Xem thêm\n        ")])])])],2),t._v(" "),e("div",{staticClass:"col-md-3 pl-2"},[e("div",{staticClass:"card shadow rounded-lg border-0 sticky-top"},[e("div",{staticClass:"card-body"},[e("h4",{staticClass:"card-title text-center text-uppercase"},[t._v("Công ty nổi bật")]),t._v(" "),t.isLoading?e("div",{staticClass:"text-center py-5"},[t._m(4)]):t._l(t.topPartners,function(s){return e("router-link",{key:s.id,staticClass:"card-link text-dark",attrs:{to:{name:"Company Detail",params:{companyId:s.id}},title:s.name}},[e("div",{staticClass:"d-flex flex-row justify-content-between"},[e("p",{staticClass:"text-truncate my-1 mr-3"},[t._v(t._s(s.name))]),t._v(" "),e("span",{staticClass:"font-weight-bold text-warning my-1"},[t._v("\n              "+t._s(t._f("myRating")(null==s.avg_partner_scores?"0":s.avg_partner_scores))+"\n              ")])])])})],2)])]),t._v(" "),e("modal-normal",[e("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("Cập nhật bình luận")]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),e("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"commentContent"}},[t._v("Nội dung bình luận")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.commentEdit.content,expression:"commentEdit.content"}],staticClass:"form-control",attrs:{id:"commentContent",rows:"2"},domProps:{value:t.commentEdit.content},on:{input:function(s){s.target.composing||t.$set(t.commentEdit,"content",s.target.value)}}})])]),t._v(" "),e("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("\n        Hủy\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:function(s){return t.updateComment()}}},[e("i",{staticClass:"fas fa-save"}),t._v(" Lưu\n      ")])])])],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"spinner-border",attrs:{role:"status"}},[s("span",{staticClass:"sr-only"},[this._v("Loading...")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"mr-auto"},[s("h5",{staticClass:"card-title text-uppercase"},[this._v("Đăng bài")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"spinner-border",attrs:{role:"status"}},[s("span",{staticClass:"sr-only"},[this._v("Loading...")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"spinner-grow spinner-grow-sm",attrs:{role:"status"}},[s("span",{staticClass:"sr-only"},[this._v("Loading...")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"spinner-border",attrs:{role:"status"}},[s("span",{staticClass:"sr-only"},[this._v("Loading...")])])}]};var o=function(t){e("W4yH")},i=e("VU/8")(a.a,n,!1,o,null,null);s.default=i.exports},VDu0:function(t,s,e){"use strict";(function(t){var a=e("Dd8w"),n=e.n(a),o=e("Xxa5"),i=e.n(o),r=e("exGp"),c=e.n(r),l=e("NYxO"),d=e("IcnI"),m=e("mtWM");e.n(m);s.a={name:"HomeView",data:function(){return{searchLocationText:"",locations:[],selectedLocation:"",postContent:"",rating:null,files:[],showCardPost:!1,isCardShow:!1,loadingButton:!1,postIdSelected:null,commentMode:!1,commentContent:"",optionComment:!1,commentIdSelected:null,postIdSelectedO:null,optionPost:!1,commentEdit:{id:"",content:""},currentPagePost:1,loadingLoadMore:!1}},created:function(){d.a.dispatch("home/TOP_LOCATIONS_FETCH"),d.a.dispatch("home/TOP_PARTNERS_FETCH"),d.a.dispatch("home/POSTS_FETCH"),d.a.dispatch("home/COMMENTS_FETCH")},watch:{searchLocationText:function(t){var s=this;return c()(i.a.mark(function e(){var a,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.LOCATIONS_SEARCH(t);case 2:a=e.sent,n=a.data,s.locations=n;case 5:case"end":return e.stop()}},e,s)}))()}},computed:n()({},Object(l.c)("home",["posts","comments","topLocations","topPartners","isLoading"]),Object(l.c)("authentication",["currentUser","isAuthenticated"])),methods:n()({},Object(l.b)("home",["POST_CREATE","COMMENTS_FETCH","FETCH_MORE_DATA","POST_UPDATE","POST_DELETE","COMMENT_CREATE","COMMENT_UPDATE","COMMENT_DELETE"]),Object(l.b)("location",["LOCATIONS_SEARCH"]),Object(l.b)("imagepost",["IMAGES_CREATE","IMAGES_DELETE","IMAGES_SHOW"]),{paginatePost:function(){var t=this;return c()(i.a.mark(function s(){var e;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t.loadingLoadMore=!0,t.currentPagePost+=1,e=t.currentPagePost,s.next=5,t.FETCH_MORE_DATA(e);case 5:t.loadingLoadMore=!1;case 6:case"end":return s.stop()}},s,t)}))()},onClickCommentPost:function(t){this.postIdSelected=t,this.commentMode=!this.commentMode},onListenerClick:function(t){return this.postIdSelected==t},onClickDeletePost:function(t){confirm("Bạn có chắc chắn?")&&this.POST_DELETE(t)},getImageData:function(t){return t.map(function(t){return'<img class="post-image" src="https://storage.googleapis.com/cdio-cots.appspot.com/uploads/posts/'+t.image_name+'" />'})},openEditComment:function(s){this.commentEdit.content=s.comment_content,this.commentEdit.id=s.id,t(".normal__modal").modal("show")},openEditPost:function(s){this.postEdit.content=postEdit.comment_content,this.postEdit.id=postEdit.id,t(".normal__modal").modal("show")},toggleMenuComment:function(t){this.commentIdSelected=t,this.optionComment=!this.optionComment},onListenerClickEditComment:function(t){return this.commentIdSelected==t},getUrlImage:function(t){return"https://storage.googleapis.com/cdio-cots.appspot.com/uploads/users/"+t},getUrlImagePost:function(t){return"https://storage.googleapis.com/cdio-cots.appspot.com/uploads/posts/"+t},onClickBookTour:function(){this.$router.push({name:"All Tour"})},onClickPost:function(){this.searchLocationText="",this.locations=[],this.selectedLocation="",this.postContent="",this.rating=null,this.files=[],this.showCardPost=!0,this.isCardShow=!0},onCloseCardPost:function(){this.searchLocationText="",this.locations=[],this.selectedLocation="",this.postContent="",this.rating=null,this.files=[],this.showCardPost=!1,this.isCardShow=!1},getImage:function(t){this.IMAGE_SHOW(t.id)},handleFileUploads:function(){this.files=this.$refs.imageUploads.files},clearDataState:function(){this.searchLocationText="",this.locations=[],this.selectedLocation="",this.postContent="",this.rating=null,this.files=[]},createPost:function(){var t=this;return c()(i.a.mark(function s(){var e,a,n,o,r,c;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t.loadingButton=!0,e={post_content:t.postContent,post_scores:t.rating,location_id:t.selectedLocation.id},s.prev=2,s.next=5,t.POST_CREATE(e);case 5:if(a=s.sent,n=t.files,!((o=n.length)<=0)){s.next=14;break}return t.clearDataState(),t.loadingButton=!1,t.showCardPost=!1,t.isCardShow=!1,s.abrupt("return");case 14:for(r=0;r<o;r++)(c=new FormData).append("image_name",n[r]),c.append("post_id",a.id),t.IMAGES_CREATE(c);t.clearDataState(),t.loadingButton=!1,t.showCardPost=!1,t.isCardShow=!1,t.loadingButton=!1,s.next=29;break;case 22:s.prev=22,s.t0=s.catch(2),t.clearDataState(),t.loadingButton=!1,t.showCardPost=!1,t.isCardShow=!1,t.$toast.error({color:"#BD362F",title:"Error!",message:"Something wrong: "+s.t0.data});case 29:case"end":return s.stop()}},s,t,[[2,22]])}))()},toggleMenuPost:function(t){this.postIdSelectedO=t,this.optionPost=!this.optionPost},onListenerClickEditPost:function(t){return this.postIdSelectedO==t},sendComment:function(t){var s={comment_content:this.commentContent,post_id:t,user_id:this.currentUser.id};this.COMMENT_CREATE(s),this.commentContent=""},deleteComment:function(t){confirm("Bạn có chắc chắn?")&&this.COMMENT_DELETE(t)},updateComment:function(){var s=this;return c()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:s.commentEdit.id,updatedFields:{comment_content:s.commentEdit.content}},e.next=3,s.COMMENT_UPDATE(a);case 3:t(".normal__modal").modal("hide"),s.optionComment=!1;case 5:case"end":return e.stop()}},e,s)}))()}})}}).call(s,e("7t+N"))},W4yH:function(t,s){}});
//# sourceMappingURL=4.9ac31877e0af0275a599.js.map