webpackJsonp([11],{AWii:function(t,e,s){"use strict";(function(t){var a=s("Xxa5"),o=s.n(a),n=s("exGp"),i=s.n(n),r=s("Dd8w"),l=s.n(r),c=s("NYxO"),d=s("IcnI");e.a={data:function(){return{editMode:!1,loadingButton:!1,id:null,postContent:null,rating:null,selectedLocation:null,files:[],searchLocationText:null,locations:[],currentLocation:null,currentLocationId:null,currentScores:null,searchText:null,user:{},urlImage:null}},created:function(){d.a.dispatch("post/POSTS_FETCH"),d.a.dispatch("imagepost/IMAGES_FETCH")},computed:l()({},Object(c.c)("post",["posts","errors","isPostLoading"]),Object(c.c)("imagepost",["images","isLoadingImage"])),watch:{searchLocationText:function(t){var e=this;return i()(o.a.mark(function s(){var a,n;return o.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.LOCATIONS_SEARCH(t);case 2:a=s.sent,n=a.data,e.locations=n;case 5:case"end":return s.stop()}},s,e)}))()}},methods:l()({},Object(c.b)("post",["POST_CREATE","POST_UPDATE","POST_DELETE","POSTS_PAGINATE","POSTS_SEARCH","POST_CHANGE_STATUS"]),Object(c.b)("user",["USER_ONE_FETCH"]),Object(c.b)("location",["LOCATIONS_SEARCH"]),Object(c.b)("imagepost",["IMAGES_CREATE","IMAGES_DELETE","IMAGES_SHOW"]),{fetchNameCheck:function(t){return"checkbox_"+t.id},searchUp:function(){this.POSTS_SEARCH(this.searchText)},onChangeStatus:function(t,e){var s=0;!0===t.target.checked&&(s=1);var a={id:e.id,is_active:s};this.POST_CHANGE_STATUS(a)},handleFileUploads:function(){this.files=this.$refs.imagePosts.files},show:function(t){this.IMAGES_SHOW(t.id)},getUrlImage:function(t){return"https://storage.googleapis.com/cdio-cots.appspot.com/uploads/users/"+t},clickPaginate:function(t){console.log(t),this.POSTS_PAGINATE(t)},newModal:function(){this.editMode=!1,this.postContent=null,this.rating=null,this.selectedLocation=null,this.searchLocationText=null,this.currentLocation=null,this.currentLocationId=null,this.currentScores=null,this.searchText=null,t("#modalPost").modal("show")},closeModal:function(){this.editMode=!1,this.postContent=null,this.rating=null,this.selectedLocation=null,this.searchLocationText=null,this.currentLocation=null,this.currentLocationId=null,this.currentScores=null,this.searchText=null,t("#modalPost").modal("hide")},updateModal:function(e){this.editMode=!0,this.id=e.id,this.postContent=e.post_content,this.currentScores=e.post_scores,this.currentLocation=e.location.location_name,this.currentLocationId=e.location.id,t("#modalPost").modal("show")},updatePost:function(){var e=this;return i()(o.a.mark(function s(){var a,n;return o.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e.loadingButton=!0,a=null,a=null===e.selectedLocation?e.currentLocationId:e.selectedLocation.id,s.prev=3,s.next=6,e.POST_UPDATE({id:e.id,updatedFields:{post_content:e.postContent,post_scores:e.currentScores,location_id:a}});case 6:if(s.sent,n=e.files,!(n.length<=0)){s.next=19;break}return t("#modalPost").modal("hide"),e.loadingButton=!1,e.$toast.success({color:"#51A351",title:"Success!",message:"Cập nhật bài đăng thành công"}),s.abrupt("return");case 19:s.next=26;break;case 21:s.prev=21,s.t0=s.catch(3),t("#modalPost").modal("hide"),e.loadingButton=!1,e.$toast.error({color:"#BD362F",title:"Error!",message:"Cập nhật bài đăng thất bại"});case 26:case"end":return s.stop()}},s,e,[[3,21]])}))()},viewDetailUser:function(e){var s=this;this.USER_ONE_FETCH(e.user.id).then(function(e){var a=e.data;s.user=a,s.urlImage=s.getUrlImage(a.avatar),t(".details__modal").modal("show")})},createPost:function(){var e=this;return i()(o.a.mark(function s(){var a,n,i,r,l,c;return o.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e.loadingButton=!0,a={post_content:e.postContent,post_scores:e.rating,location_id:e.selectedLocation.id},s.prev=2,s.next=5,e.POST_CREATE(a);case 5:if(n=s.sent,i=e.files,!((r=i.length)<=0)){s.next=13;break}return t("#modalPost").modal("hide"),e.loadingButton=!1,e.$toast.success({color:"#51A351",title:"Success!",message:"Thêm bài đăng thành công"}),s.abrupt("return");case 13:for(l=0;l<r;l++)(c=new FormData).append("image_name",i[l]),c.append("post_id",n.id),e.IMAGES_CREATE(c);t("#modalPost").modal("hide"),e.loadingButton=!1,e.$toast.success({color:"#51A351",title:"Success!",message:"Thêm bài đăng thành công"}),s.next=24;break;case 19:s.prev=19,s.t0=s.catch(2),t("#modalPost").modal("hide"),e.loadingButton=!1,e.$toast.error({color:"#BD362F",title:"Error!",message:"Thêm bài đăng thất bại"});case 24:case"end":return s.stop()}},s,e,[[2,19]])}))()},deleteModal:function(e){t(".submit__delete__modal").modal("show"),this.id=e.id},submitDelete:function(){var e=this;return i()(o.a.mark(function s(){return o.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e.loadingButton=!0,s.prev=1,s.next=4,e.POST_DELETE(e.id);case 4:e.IMAGES_DELETE(e.id),t(".submit__delete__modal").modal("hide"),e.loadingButton=!1,e.$toast.success({color:"#51A351",title:"Success!",message:"Xoá bài đăng thành công"}),s.next=15;break;case 10:s.prev=10,s.t0=s.catch(1),t(".submit__delete__modal").modal("hide"),e.loadingButton=!1,e.$toast.error({color:"#BD362F",title:"Error!",message:"Xoá bài đăng thất bại"});case 15:case"end":return s.stop()}},s,e,[[1,10]])}))()}})}}).call(e,s("7t+N"))},OMyL:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("AWii"),o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"card"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"d-flex flex-row justify-content-between mb-2"},[t._m(0),t._v(" "),s("div",{staticClass:"d-flex flex-row"},[s("div",{staticClass:"py-1 mr-2"},[s("button",{staticClass:"btn btn-success",on:{click:t.newModal}},[s("i",{staticClass:"fas fa-plus"}),t._v("\n              Thêm\n            ")])]),t._v(" "),s("div",[s("form",{staticClass:"input-group",on:{submit:function(e){return e.preventDefault(),t.searchUp()}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control form-control-sm",attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),t._v(" "),t._m(1)])])])]),t._v(" "),s("table",{staticClass:"table table-hover"},[s("caption",[t._v("\n          List of post\n        ")]),t._v(" "),t._m(2),t._v(" "),s("tbody",[t.isPostLoading?s("tr",{staticClass:"text-center"},[t._m(3)]):t._l(t.posts.data,function(e,a){return s("tr",{key:a},[s("th",{attrs:{scope:"row"}},[t._v(t._s(++a))]),t._v(" "),s("td",[s("p",{staticClass:"text-truncate",staticStyle:{"max-width":"200px"}},[t._v("\n                "+t._s(e.post_content)+"\n              ")])]),t._v(" "),s("td",[s("h6",{staticClass:"text-warning"},[s("i",{staticClass:"fas fa-star"}),t._v("\n                "+t._s(e.post_scores)+"\n              ")])]),t._v(" "),s("td",[s("p",{staticClass:"text-truncate",staticStyle:{"max-width":"200px"}},[t._v("\n                "+t._s(e.location.location_name)+"\n              ")])]),t._v(" "),s("td",[s("a",{staticClass:"text-primary",attrs:{href:"#"},on:{click:function(s){return t.viewDetailUser(e)}}},[t._v("\n                "+t._s(e.user.name)+"\n              ")])]),t._v(" "),s("td",[t._v(t._s(e.likes.length))]),t._v(" "),s("td",{staticClass:"text-center"},[s("span",{class:1===e.is_active?"badge badge-success":"badge badge-danger"},[t._v("\n                "+t._s(1===e.is_active?"Active":"Blocked")+"\n              ")])]),t._v(" "),s("td",{staticClass:"text-center"},[s("div",{staticClass:"custom-control custom-checkbox"},[s("input",{staticClass:"custom-control-input",attrs:{type:"checkbox",value:"0",id:t.fetchNameCheck(e)},domProps:{checked:1===e.is_active},on:{change:function(s){return t.onChangeStatus(s,e)}}}),t._v(" "),s("label",{staticClass:"custom-control-label",attrs:{for:t.fetchNameCheck(e)}})])]),t._v(" "),s("td",{staticClass:"text-center"},[s("a",{staticClass:"mr-2",attrs:{href:"#"},on:{click:function(s){return t.updateModal(e)}}},[s("i",{staticClass:"menu-icon icon-pencil text-info"})]),t._v(" "),s("a",{staticClass:"ml-2",attrs:{href:"#"},on:{click:function(s){return t.deleteModal(e)}}},[s("i",{staticClass:"menu-icon icon-bin2 text-danger"})])])])})],2)]),t._v(" "),s("paginate",{attrs:{"page-count":null==t.posts.last_page?1:t.posts.last_page,"click-handler":t.clickPaginate,"prev-text":"Prev","next-text":"Next","container-class":"pagination justify-content-end","page-class":"page-item","page-link-class":"page-link","prev-class":"page-item","prev-link-class":"page-link","next-class":"page-item","next-link-class":"page-link"}})],1)]),t._v(" "),s("div",{staticClass:"modal fade",attrs:{id:"modalPost",tabindex:"-1",role:"dialog","aria-labelledby":"modalTitle","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-header"},[s("h5",{directives:[{name:"show",rawName:"v-show",value:!t.editMode,expression:"!editMode"}],staticClass:"modal-title",attrs:{id:"modalTitle"}},[t._v("\n            Thêm bài đăng\n          ")]),t._v(" "),s("h5",{directives:[{name:"show",rawName:"v-show",value:t.editMode,expression:"editMode"}],staticClass:"modal-title",attrs:{id:"modalTitle"}},[t._v("\n            Cập nhật bài đăng\n          ")]),t._v(" "),s("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:function(e){return t.closeModal()}}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),s("form",{on:{submit:function(e){e.preventDefault(),t.editMode?t.updatePost():t.createPost()}}},[s("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var a=e.valid;return[s("div",{staticClass:"modal-body"},[s("div",{staticClass:"form-gourp"},[null===t.currentLocation?s("label",[t._v("Địa điểm")]):s("label",[t._v("Địa điểm hiện tại\n                  "),s("i",{staticClass:"text-info"},[t._v(t._s(t.currentLocation))])]),t._v(" "),s("vue-bootstrap-typeahead",{attrs:{data:t.locations,serializer:function(t){return t.location_name},placeholder:"Tìm địa điểm..."},on:{hit:function(e){t.selectedLocation=e}},model:{value:t.searchLocationText,callback:function(e){t.searchLocationText=e},expression:"searchLocationText"}})],1),t._v(" "),s("div",{staticClass:"form-gourp"},[s("ValidationProvider",{attrs:{name:"content",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[s("label",[t._v("Nội dung")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.postContent,expression:"postContent"}],staticClass:"form-control",class:{"is-invalid":a[0]},attrs:{placeholder:"Bạn suy nghĩ gì",rows:"3"},domProps:{value:t.postContent},on:{input:function(e){e.target.composing||(t.postContent=e.target.value)}}}),t._v(" "),s("div",{staticClass:"invalid-feedback"},[t._v(t._s(a[0]))])]}}],null,!0)})],1),t._v(" "),s("div",{staticClass:"form-group"},[s("label",[t._v("Điểm")]),t._v(" "),!1===t.editMode?s("star-rating",{attrs:{"star-size":20},model:{value:t.rating,callback:function(e){t.rating=e},expression:"rating"}}):s("star-rating",{attrs:{"star-size":20},model:{value:t.currentScores,callback:function(e){t.currentScores=e},expression:"currentScores"}})],1),t._v(" "),s("div",{staticClass:"form-group"},[s("label",[t._v("Hình\n                  "),s("i",{staticClass:"text-danger"},[t._v("(chọn ít nhất 1 hình)")])]),t._v(" "),s("input",{ref:"imagePosts",staticClass:"form-control-file",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:function(e){return t.handleFileUploads()}}})])]),t._v(" "),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){return t.closeModal()}}},[t._v("\n                Huỷ\n              ")]),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:!t.editMode,expression:"!editMode"}],staticClass:"btn btn-primary",attrs:{type:"submit",disabled:!a}},[t.loadingButton?s("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e(),t._v("\n                Thêm\n              ")]),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:t.editMode,expression:"editMode"}],staticClass:"btn btn-primary",attrs:{type:"submit",disabled:!a}},[t.loadingButton?s("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e(),t._v("\n                Cập nhật\n              ")])])]}}])})],1)])])]),t._v(" "),s("submit-delete-modal",[s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("\n        Huỷ\n      ")]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.submitDelete}},[t.loadingButton?s("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e(),t._v("\n        Có\n      ")])])]),t._v(" "),s("details-modal",[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title",attrs:{id:"modalTitle"}},[t._v("Thông tin người bình luận")]),t._v(" "),s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-4"},[s("img",{staticClass:"rounded-circle img-fulid",attrs:{src:t.urlImage,width:"150px"}})]),t._v(" "),s("div",{staticClass:"col-8"},[s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-4 col-form-label"},[t._v("Email:")]),t._v(" "),s("div",{staticClass:"col-8"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-4 col-form-label"},[t._v("Tên hiển thị:")]),t._v(" "),s("div",{staticClass:"col-8"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.name,expression:"user.name"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.user.name},on:{input:function(e){e.target.composing||t.$set(t.user,"name",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-4 col-form-label"},[t._v("Địa chỉ:")]),t._v(" "),s("div",{staticClass:"col-8"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.address,expression:"user.address"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.user.address},on:{input:function(e){e.target.composing||t.$set(t.user,"address",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-4 col-form-label"},[t._v("Số điện thoại:")]),t._v(" "),s("div",{staticClass:"col-8"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.phone_number,expression:"user.phone_number"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.user.phone_number},on:{input:function(e){e.target.composing||t.$set(t.user,"phone_number",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-4 col-form-label"},[t._v("Mô tả:")]),t._v(" "),s("div",{staticClass:"col-8"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.user.description,expression:"user.description"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.user.description},on:{input:function(e){e.target.composing||t.$set(t.user,"description",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-4 col-form-label",attrs:{for:"show-ten"}},[t._v("Trạng thái:")]),t._v(" "),s("div",{staticClass:"col-8"},[s("span",{class:1===t.user.is_active?"badge badge-success":"badge badge-danger"},[t._v(t._s(1===t.user.is_active?"Active":"Blocked"))])])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-4 col-form-label"},[t._v("Quyền:")]),t._v(" "),s("div",{staticClass:"col-8"},[s("span",{staticClass:"badge badge-primary"},[t._v(t._s(1===t.user.role_id?"admin":2===t.user.role_id?"partner":"user"))])])])])])]),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("\n        Đóng\n      ")])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h5",{staticClass:"card-title"},[this._v("Danh sách bài đăng")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-append"},[e("button",{staticClass:"btn btn-light",attrs:{type:"submit"}},[e("i",{staticClass:"fas fa-search"})])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{attrs:{scope:"col"}},[t._v("STT")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Nội dung")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Điểm")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Địa điểm")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Người đăng")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Lượt thích")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Status")]),t._v(" "),s("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Active")]),t._v(" "),s("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Tuỳ chọn")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("td",{attrs:{colspan:"8"}},[e("div",{staticClass:"spinner-border",attrs:{role:"status"}},[e("span",{staticClass:"sr-only"},[this._v("Loading...")])])])}]};var n=function(t){s("ievT")},i=s("VU/8")(a.a,o,!1,n,null,null);e.default=i.exports},ievT:function(t,e){}});
//# sourceMappingURL=11.dba15e0d111461dc833e.js.map